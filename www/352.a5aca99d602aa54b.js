"use strict";(self.webpackChunkwebui=self.webpackChunkwebui||[]).push([[352],{5352:(xi,H,r)=>{r.r(H),r.d(H,{AdminModule:()=>Ti});var p=r(6814),c=r(1567),gt=r(8033),bt=r(3542),zt=r(4697),vt=r(8211),L=r(2920),m=r(2962),f=r(95),yt=r(3298),t=r(9212);const Ct=["test"],Tt=["editor"];function xt(i,s){1&i&&t._UZ(0,"app-input-product",9),2&i&&t.Q6J("formControl",s.control)}const kt=()=>[16,16];let Et=(()=>{class i{constructor(){this.fields=[{key:"test",type:"text",label:"test"},{key:"zzz",type:"template",label:"zzz",template:this.test},{key:"abc",type:"table",label:"abc",children:[{key:"a",type:"number",label:"A"},{key:"b",type:"number",label:"B"},{key:"c",type:"table",label:"def",children:[{key:"d",type:"number",label:"D"},{key:"e",type:"number",label:"E"}]},{key:"f",type:"object",label:"C",children:[{key:"a",type:"number",label:"A"},{key:"b",type:"number",label:"B"}]}]}],this.values={test:"\u5f20\u6770\u4e00",abc:[{a:1,b:2,f:{a:2,b:3}}]}}ngAfterViewInit(){setTimeout(()=>{this.fields[1].template=this.test})}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-dash"]],viewQuery:function(n,o){if(1&n&&(t.Gf(Ct,5),t.Gf(Tt,5)),2&n){let a;t.iGM(a=t.CRH())&&(o.test=a.first),t.iGM(a=t.CRH())&&(o.editor=a.first)}},standalone:!0,features:[t.jDz],decls:21,vars:2,consts:[[3,"nzGutter"],["nzSpan","8"],["model","gateway","title","\u7f51\u5173\u603b\u6570"],["model","device","title","\u8bbe\u5907\u603b\u6570"],["model","product","title","\u4ea7\u54c1\u603b\u6570"],["model","project","title","\u9879\u76ee\u603b\u6570"],["model","space","title","\u7a7a\u95f4\u603b\u6570"],["model","user","title","\u7528\u6237\u603b\u6570"],["test",""],[3,"formControl"]],template:function(n,o){1&n&&(t.TgZ(0,"nz-row",0)(1,"nz-col",1)(2,"nz-card"),t._UZ(3,"app-count",2),t.qZA()(),t.TgZ(4,"nz-col",1)(5,"nz-card"),t._UZ(6,"app-count",3),t.qZA()(),t.TgZ(7,"nz-col",1)(8,"nz-card"),t._UZ(9,"app-count",4),t.qZA()(),t.TgZ(10,"nz-col",1)(11,"nz-card"),t._UZ(12,"app-count",5),t.qZA()(),t.TgZ(13,"nz-col",1)(14,"nz-card"),t._UZ(15,"app-count",6),t.qZA()(),t.TgZ(16,"nz-col",1)(17,"nz-card"),t._UZ(18,"app-count",7),t.qZA()()(),t.YNc(19,xt,1,1,"ng-template",null,8,t.W1O)),2&n&&t.Q6J("nzGutter",t.DdM(1,kt))},dependencies:[vt.S,L.SK,L.t3,m.bd,f.u5,f.JJ,yt.Q,f.UX,f.oH]})}return i})();var Zt=r(8605),d=r(2840),b=r(944),g=r(3460),u=r(4430);const At=["form"];function St(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let j=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.fields=[{key:"id",label:"ID",type:"text",min:2,max:30,placeholder:"\u9009\u586b"},{key:"name",label:"\u540d\u79f0",type:"text",required:!0,default:"\u65b0\u4ea7\u54c1"},{key:"keywords",label:"\u5173\u952e\u5b57",type:"tags",default:[]},{key:"icon",label:"\u56fe\u6807",type:"text"},{key:"version",label:"\u7248\u672c",type:"text"},{key:"protocol",label:"\u534f\u8bae",type:"text"},{key:"url",label:"\u94fe\u63a5",type:"text"},{key:"description",label:"\u8bf4\u660e",type:"textarea"}],this.values={}}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load())}load(){this.rs.get("product/"+this.id).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post(`product/${this.id||"create"}`,this.form.value).subscribe(n=>{this.router.navigateByUrl("/admin/product/"+n.data.id),this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(At,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:4,consts:[[3,"nzTitle","nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,St,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzTitle","\u4ea7\u54c1"+(o.id?"\u7f16\u8f91":"\u521b\u5efa"))("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();var z=r(2574),k=r(9035),A=r(5387),h=r(9382),w=r(4354),R=r(3898),T=r(7582),y=r(9773),C=r(3064),N=r(9087),E=r(7754),B=r(9388);const wt=["*"],W="collapse";let Nt=(()=>{class i{constructor(e,n,o,a){this.nzConfigService=e,this.cdr=n,this.directionality=o,this.destroy$=a,this._nzModuleName=W,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="left",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.nzConfigService.getConfigChangeEventForComponent(W).pipe((0,y.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe((0,y.R)(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(e){this.listOfNzCollapsePanelComponent.push(e)}removePanel(e){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(e),1)}click(e){this.nzAccordion&&!e.nzActive&&this.listOfNzCollapsePanelComponent.filter(n=>n!==e).forEach(n=>{n.nzActive&&(n.nzActive=!1,n.nzActiveChange.emit(n.nzActive),n.markForCheck())}),e.nzActive=!e.nzActive,e.nzActiveChange.emit(e.nzActive)}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(C.jY),t.Y36(t.sBO),t.Y36(B.Is,8),t.Y36(N.kn))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function(n,o){2&n&&t.ekj("ant-collapse-icon-position-left","left"===o.nzExpandIconPosition)("ant-collapse-icon-position-right","right"===o.nzExpandIconPosition)("ant-collapse-ghost",o.nzGhost)("ant-collapse-borderless",!o.nzBordered)("ant-collapse-rtl","rtl"===o.dir)},inputs:{nzAccordion:"nzAccordion",nzBordered:"nzBordered",nzGhost:"nzGhost",nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],standalone:!0,features:[t._Bn([N.kn]),t.jDz],ngContentSelectors:wt,decls:1,vars:0,template:function(n,o){1&n&&(t.F$t(),t.Hsn(0))},encapsulation:2,changeDetection:0})}return(0,T.gn)([(0,C.oS)(),(0,E.yF)()],i.prototype,"nzAccordion",void 0),(0,T.gn)([(0,C.oS)(),(0,E.yF)()],i.prototype,"nzBordered",void 0),(0,T.gn)([(0,C.oS)(),(0,E.yF)()],i.prototype,"nzGhost",void 0),i})();function Mt(i,s){if(1&i&&t._UZ(0,"app-product-version",6),2&i){const e=t.oxw();t.Q6J("product_id",e.id)}}function Pt(i,s){if(1&i&&t._UZ(0,"app-devices",7),2&i){const e=t.oxw();t.Q6J("product_id",e.id)("project_id",e.project_id)}}function Ot(i,s){1&i&&(t.TgZ(0,"button",11),t._uU(1,"\u7f16\u8f91"),t.qZA())}function It(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("nzOnConfirm",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.delete())}),t._uU(1,"\u5220\u9664"),t.qZA()}}function Ut(i,s){1&i&&(t.TgZ(0,"nz-space"),t.YNc(1,Ot,2,0,"button",9)(2,It,2,0,"button",10),t.qZA())}function Yt(i,s){if(1&i&&t.YNc(0,Ut,3,0,"nz-space",8),2&i){const e=t.oxw();t.Q6J("ngIf",!e.project_id)}}let Bt=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.base="/admin",this.value="",this.data={},this.fields=[{label:"ID",key:"id"},{label:"\u540d\u79f0",key:"name"},{label:"\u5173\u952e\u5b57",key:"keywords",type:"tags"},{label:"\u521b\u5efa\u65f6\u95f4",key:"created",type:"date"},{label:"\u8bf4\u660e",key:"description",span:2}]}ngOnInit(){this.route.parent?.snapshot.paramMap.has("project")&&(this.project_id=this.route.parent?.snapshot.paramMap.get("project"),this.base=`/project/${this.project_id}`),this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load())}load(){this.rs.get(`product/${this.id}`,{}).subscribe(e=>{this.data=e.data})}delete(){this.rs.get(`product/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529f"),this.router.navigateByUrl("admin/product")}),this.load()}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-detail"]],standalone:!0,features:[t.jDz],decls:10,vars:3,consts:[["nzTitle","\u4ea7\u54c1\u8be6\u60c5",3,"nzExtra"],[3,"fields","value"],["nzTitle","\u4ea7\u54c1\u7248\u672c"],["nz-tab",""],["nzTitle","\u4ea7\u54c1\u8bbe\u5907"],["extra",""],[3,"product_id"],[3,"product_id","project_id"],[4,"ngIf"],["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-info",1)(2,"nz-collapse"),t.TgZ(3,"nz-tabset")(4,"nz-tab",2),t.YNc(5,Mt,1,1,"ng-template",3),t.qZA(),t.TgZ(6,"nz-tab",4),t.YNc(7,Pt,1,2,"ng-template",3),t.qZA()()(),t.YNc(8,Yt,1,1,"ng-template",null,5,t.W1O)),2&n){const a=t.MAs(9);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("value",o.data)}},dependencies:[p.ez,p.O5,A.E,m.bd,z.NU,d.ix,z.$1,c.rH,k.JW,h.we,h.xH,h.xw,h.cj,w.Z,R.P,Nt]})}return i})();var K=r(5729),Jt=r(9891),Qt=r(1620),D=r(3106);const $t=["form"];function Gt(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let X=(()=>{class i{constructor(e,n,o,a,l){this.router=e,this.ms=n,this.msg=o,this.rs=a,this.route=l,this.base="/admin",this.id="",this.fields=[{key:"id",label:"ID",type:"text",min:2,max:30,placeholder:"\u9009\u586b"},{key:"name",label:"\u540d\u79f0",type:"text",required:!0,default:"\u65b0\u7f51\u5173"},{key:"keywords",label:"\u5173\u952e\u5b57",type:"tags",default:[]},{key:"description",label:"\u8bf4\u660e",type:"textarea"},{key:"username",label:"MQTT\u7528\u6237\u540d",type:"text"},{key:"password",label:"MQTT\u5bc6\u7801",type:"text"}],this.values={}}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load())}ngAfterViewInit(){}load(){this.rs.get(`gateway/${this.id}`).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post(`gateway/${this.id||"create"}`,this.form.value).subscribe(n=>{this.router.navigateByUrl(`${this.base}/gateway/`+n.data.id),this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(D.Sf),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-gateway-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf($t,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:4,consts:[[3,"nzTitle","nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,Gt,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzTitle","\u7f51\u5173"+(o.id?"\u7f16\u8f91":"\u521b\u5efa"))("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();function qt(i,s){if(1&i&&t._UZ(0,"app-devices",6),2&i){const e=t.oxw();t.Q6J("gateway_id",e.id)}}function Ht(i,s){}function Lt(i,s){1&i&&(t.TgZ(0,"button",9),t._uU(1,"\u7f16\u8f91"),t.qZA())}function jt(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("nzOnConfirm",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.delete())}),t._uU(1,"\u5220\u9664"),t.qZA()}}function Rt(i,s){1&i&&(t.TgZ(0,"nz-space"),t.YNc(1,Lt,2,0,"button",7)(2,jt,2,0,"button",8),t.qZA())}let Wt=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.base="/admin",this.data={},this.loading=!1,this.fields=[{key:"id",label:"ID"},{key:"name",label:"\u540d\u79f0"},{key:"project",label:"\u9879\u76ee",type:"link",link:()=>`${this.base}/project/${this.data.project_id}`},{key:"username",label:"\u7528\u6237\u540d"},{key:"password",label:"\u5bc6\u7801"},{key:"created",label:"\u521b\u5efa\u65f6\u95f4",type:"date"},{key:"description",label:"\u8bf4\u660e",span:2}]}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load())}load(){this.loading=!0,this.rs.post("gateway/search",{filter:{id:this.id}}).subscribe(e=>{this.data=e.data[0]}).add(()=>this.loading=!1)}delete(){this.rs.get(`gateway/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529f"),this.router.navigateByUrl(`${this.base}/gateway`)})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-gateway-detail"]],standalone:!0,features:[t.jDz],decls:9,vars:3,consts:[["nzTitle","\u7f51\u5173\u8be6\u60c5",3,"nzExtra"],[3,"fields","value"],["nzTitle","\u7f51\u5173\u8bbe\u5907"],["nz-tab",""],["nzTitle","\u62a5\u8b66\u65e5\u5fd7"],["extra",""],[3,"gateway_id"],["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-info",1),t.TgZ(2,"nz-tabset")(3,"nz-tab",2),t.YNc(4,qt,1,1,"ng-template",3),t.qZA(),t.TgZ(5,"nz-tab",4),t.YNc(6,Ht,0,0,"ng-template",3),t.qZA()()(),t.YNc(7,Rt,3,0,"ng-template",null,5,t.W1O)),2&n){const a=t.MAs(8);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("value",o.data)}},dependencies:[p.ez,A.E,m.bd,z.NU,z.$1,d.ix,c.rH,k.JW,h.we,h.xH,h.xw,h.cj,w.Z]})}return i})();var Kt=r(9866),V=r(2620),Xt=r(5565),Vt=r(6716),tt=r(4508),te=r(4877),ee=r(7340);const ne=["form"];function ie(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let et=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.fields=[{key:"id",label:"ID",type:"text",min:2,max:30,placeholder:"\u9009\u586b"},{key:"name",label:"\u540d\u79f0",type:"text",required:!0},{key:"email",label:"\u90ae\u7bb1",type:"text"},{key:"cellphone",label:"\u624b\u673a\u53f7",type:"text"},{key:"disabled",label:"\u7981\u7528",type:"switch"},{key:"admin",label:"\u7ba1\u7406\u5458",type:"switch"}],this.values={}}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load())}load(){this.rs.get("user/"+this.id).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post(`user/${this.id||"create"}`,this.form.value).subscribe(n=>{this.router.navigateByUrl("/admin/user/"+n.data.id),this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(ne,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:4,consts:[[3,"nzTitle","nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,ie,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzTitle","\u7528\u6237"+(o.id?"\u7f16\u8f91":"\u521b\u5efa"))("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})(),oe=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-detail"]],standalone:!0,features:[t.jDz],decls:2,vars:0,template:function(n,o){1&n&&(t.TgZ(0,"p"),t._uU(1,"user-detail works!"),t.qZA())}})}return i})();const ae=["form"];function se(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let re=(()=>{class i{constructor(e,n){this.msg=e,this.rs=n,this.fields=[{key:"port",label:"\u7aef\u53e3",type:"number",required:!0,default:8080,min:1,max:65535},{key:"debug",label:"\u8c03\u8bd5\u6a21\u5f0f",type:"switch"},{key:"cors",label:"\u8de8\u57df\u8bf7\u6c42",type:"switch"},{key:"gzip",label:"\u538b\u7f29\u6a21\u5f0f",type:"switch"},{key:"https",label:"HTTPS",type:"select",options:[{label:"\u7981\u7528",value:""},{label:"TLS",value:"TLS"},{label:"LetsEncrypt",value:"LetsEncrypt"}]},{key:"cert",label:"\u8bc1\u4e66cert",type:"file"},{key:"key",label:"\u8bc1\u4e66key",type:"file"},{key:"email",label:"E-Mail",type:"text"},{key:"hosts",label:"\u57df\u540d",type:"tags",default:[]}],this.values={}}ngOnInit(){this.rs.get("setting/web",{}).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post("setting/web",this.form.value).subscribe(n=>{this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.dD),t.Y36(u.s))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-setting-web"]],viewQuery:function(n,o){if(1&n&&t.Gf(ae,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u8bbe\u7f6e Web\u670d\u52a1",3,"nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,se,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();var v=r(2053);const le=["form"];function ce(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"a",6),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.writeExample(a.url))}),t._uU(7,"\u5199\u5165"),t.qZA()()()}if(2&i){const e=s.$implicit;t.xp6(2),t.Oqu(e.label),t.xp6(2),t.Oqu(e.url)}}function pe(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let ue=(()=>{class i{constructor(e,n){this.msg=e,this.rs=n,this.urls=[{label:"SQLite",type:"sqlite",url:"master.db"},{label:"MySQL",type:"mysql",url:"root:123456@tcp(127.0.0.1)/master?charset=utf8"},{label:"Postgres SQL",type:"postgres",url:"postgres://root:123456@127.0.0.1/master?sslmode=verify-full"},{label:"MS SQL Server",type:"sqlserver",url:"sqlserver://sa:123456@127.0.0.1?database=master&connection+timeout=30"},{label:"Oracle",type:"godror",url:'user="root" password="123456" connectString="127.0.0.1:1521/master"'}],this.fields=[{key:"type",label:"\u6570\u636e\u5e93\u7c7b\u578b",type:"select",options:[{label:"SQLite\uff08\u5185\u7f6e\uff09",value:"sqlite"},{label:"MySQL",value:"mysql"},{label:"Postgres SQL",value:"postgres"},{label:"MS SQL Server",value:"sqlserver"},{label:"Oracle",value:"godror"}]},{key:"url",label:"\u8fde\u63a5\u5b57\u7b26\u4e32",type:"text"},{key:"debug",label:"\u8c03\u8bd5\u6a21\u5f0f",type:"switch"}],this.values={}}ngOnInit(){this.rs.get("setting/database",{}).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post("setting/database",this.form.value).subscribe(n=>{this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}writeExample(e){this.form.patchValue({url:e})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.dD),t.Y36(u.s))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-setting-database"]],viewQuery:function(n,o){if(1&n&&t.Gf(le,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:15,vars:5,consts:[["nzTitle","\u8bbe\u7f6e \u6570\u636e\u5e93",3,"nzExtra"],[3,"fields","values"],["form",""],[3,"nzNoResult"],[4,"ngFor","ngForOf"],["extraTemplate",""],[3,"click"],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.TgZ(3,"nz-table",3)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"\u7c7b\u578b"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"\u793a\u4f8b"),t.qZA(),t._UZ(10,"th"),t.qZA()(),t.TgZ(11,"tbody"),t.YNc(12,ce,8,2,"tr",4),t.qZA()()(),t.YNc(13,pe,2,0,"ng-template",null,5,t.W1O)),2&n){const a=t.MAs(14);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values),t.xp6(2),t.Q6J("nzNoResult"," "),t.xp6(9),t.Q6J("ngForOf",o.urls)}},dependencies:[p.ez,p.sg,d.ix,m.bd,b.B,v.N8,v.HQ,v.Uo,v._C,v.Om,v.p0,v.$Z]})}return i})();const de=["form"];function me(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let he=(()=>{class i{constructor(e,n){this.msg=e,this.rs=n,this.fields=[{key:"enable",label:"\u542f\u7528",type:"switch",default:!0},{key:"port",label:"\u7aef\u53e3",type:"number",default:1843}],this.values={}}ngOnInit(){this.rs.get("setting/broker",{}).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post("setting/broker",this.form.value).subscribe(n=>{this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.dD),t.Y36(u.s))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-setting-broker"]],viewQuery:function(n,o){if(1&n&&t.Gf(de,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u8bbe\u7f6e MQTT\u603b\u7ebf",3,"nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,me,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();const _e=["form"];function fe(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let ge=(()=>{class i{constructor(e,n){this.msg=e,this.rs=n,this.fields=[{key:"url",label:"\u5730\u5740",type:"text",required:!0,default:""},{key:"username",label:"\u7528\u6237\u540d",type:"text"},{key:"password",label:"\u5bc6\u7801",type:"text"},{key:"client_id",label:"\u5ba2\u6237\u7aefID",type:"text"}],this.values={}}ngOnInit(){this.rs.get("setting/mqtt",{}).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post("setting/mqtt",this.form.value).subscribe(n=>{this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.dD),t.Y36(u.s))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-setting-mqtt"]],viewQuery:function(n,o){if(1&n&&t.Gf(_e,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u8bbe\u7f6e MQTT\u8fde\u63a5",3,"nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,fe,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();const be=["form"];function ze(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let ve=(()=>{class i{constructor(e,n){this.msg=e,this.rs=n,this.fields=[{key:"caller",label:"\u663e\u793a\u51fd\u6570\u8c03\u7528",type:"switch"},{key:"text",label:"\u4f7f\u7528\u6587\u672c\u683c\u5f0f",type:"switch"},{key:"level",label:"\u7b49\u7ea7",type:"select",default:"info",options:[{label:"\u8ddf\u8e2a trace",value:"trace"},{label:"\u8c03\u8bd5 debug",value:"debug"},{label:"\u4fe1\u606f info",value:"info"},{label:"\u8b66\u544a warn",value:"warn"},{label:"\u9519\u8bef error",value:"error"},{label:"\u4e25\u91cd fatal",value:"fatal"}]},{key:"type",label:"\u8f93\u51fa\u65b9\u5f0f",type:"select",default:"stdout",options:[{label:"\u6587\u4ef6",value:"file"},{label:"\u591a\u6587\u4ef6",value:"files"},{label:"\u6807\u51c6\u8f93\u51fa",value:"stdout"}]},{key:"filename",label:"\u65e5\u5fd7\u6587\u4ef6",type:"text",default:"log.txt"},{key:"compress",label:"\u65e5\u5fd7\u6587\u4ef6\u538b\u7f29",type:"switch"},{key:"max_size",label:"\u6700\u5927\u5c3a\u5bf8 MB",type:"number",default:10,min:1},{key:"max_backups",label:"\u4fdd\u7559\u6570\u91cf\uff08\u6eda\u52a8\u5220\u9664\uff09",type:"number",default:100,min:1},{key:"max_age",label:"\u6700\u5927\u4fdd\u7559\u5929\u6570",type:"number",default:30,min:1}],this.values={}}ngOnInit(){this.rs.get("setting/log",{}).subscribe(e=>{this.values=e.data})}onSubmit(){this.form.valid?this.rs.post("setting/log",this.form.value).subscribe(n=>{this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.dD),t.Y36(u.s))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-setting-log"]],viewQuery:function(n,o){if(1&n&&t.Gf(be,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u8bbe\u7f6e \u7cfb\u7edf\u65e5\u5fd7",3,"nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,ze,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})(),ye=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-setting-backup"]],standalone:!0,features:[t.jDz],decls:0,vars:0,template:function(n,o){}})}return i})();var Z=r(824);let Ce=(()=>{class i{constructor(){this.currentName="",this.name=""}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-rename"]],inputs:{currentName:"currentName"},standalone:!0,features:[t.jDz],decls:11,vars:2,consts:[["type","text","nz-input","",3,"ngModel","ngModelChange"]],template:function(n,o){1&n&&(t.TgZ(0,"table")(1,"tr")(2,"td"),t._uU(3,"\u5f53\u524d\u540d\u79f0\uff1a"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA()(),t.TgZ(6,"tr")(7,"td"),t._uU(8,"\u91cd\u547d\u540d\uff1a"),t.qZA(),t.TgZ(9,"td")(10,"input",0),t.NdJ("ngModelChange",function(l){return o.name=l}),t.qZA()()()()),2&n&&(t.xp6(5),t.Oqu(o.currentName),t.xp6(5),t.Q6J("ngModel",o.name))},dependencies:[Z.o7,Z.Zp,f.u5,f.Fj,f.JJ,f.On]})}return i})();var J=r(1394);let Te=(()=>{class i{set inputValue(e){this.name=e||""}constructor(e){this.msg=e,this.isSuccess=!1,this.load=new t.vpe,this.isSuccess=!1}handleUpload(e){if("error"!==e.type){if(e.file&&e.file.response){const n=e.file.response;n.error?this.msg.error(`${n.error}`):this.msg.success("\u4e0a\u4f20\u6210\u529f!")}}else this.msg.error("\u4e0a\u4f20\u5931\u8d25")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(g.dD))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-upload"]],inputs:{inputValue:"inputValue"},outputs:{load:"load"},standalone:!0,features:[t.jDz],decls:14,vars:2,consts:[["type","text","nz-input","",3,"ngModel","ngModelChange"],["nzAction","api/attach/upload/",3,"nzShowUploadList","nzChange"],["nz-button",""],["nz-icon","","nzType","upload"]],template:function(n,o){1&n&&(t.TgZ(0,"table")(1,"tr")(2,"td"),t._uU(3,"\u4e0a\u4f20\u8def\u5f84\uff1a"),t.qZA(),t.TgZ(4,"td")(5,"input",0),t.NdJ("ngModelChange",function(l){return o.name=l}),t.qZA()()(),t.TgZ(6,"tr")(7,"td"),t._uU(8,"\u4e0a\u4f20\u6587\u4ef6\uff1a"),t.qZA(),t.TgZ(9,"td")(10,"nz-upload",1),t.NdJ("nzChange",function(l){return o.handleUpload(l)}),t.TgZ(11,"button",2),t._UZ(12,"i",3),t._uU(13," \u4e0a\u4f20 "),t.qZA()()()()()),2&n&&(t.xp6(5),t.Q6J("ngModel",o.name),t.xp6(5),t.Q6J("nzShowUploadList",!1))},dependencies:[f.u5,f.Fj,f.JJ,f.On,J.cS,J.FY,Z.o7,Z.Zp],styles:["table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 0}"]})}return i})();var nt=r(8324);function xe(i,s){if(1&i&&(t.ynx(0),t._uU(1),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.nzText)}}function ke(i,s){if(1&i&&(t.TgZ(0,"span",1),t.YNc(1,xe,2,1,"ng-container",2),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",e.nzText)}}let it=(()=>{class i{constructor(){this.nzType="horizontal",this.nzOrientation="center",this.nzDashed=!1,this.nzPlain=!1}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["nz-divider"]],hostAttrs:[1,"ant-divider"],hostVars:16,hostBindings:function(n,o){2&n&&t.ekj("ant-divider-horizontal","horizontal"===o.nzType)("ant-divider-vertical","vertical"===o.nzType)("ant-divider-with-text",o.nzText)("ant-divider-plain",o.nzPlain)("ant-divider-with-text-left",o.nzText&&"left"===o.nzOrientation)("ant-divider-with-text-right",o.nzText&&"right"===o.nzOrientation)("ant-divider-with-text-center",o.nzText&&"center"===o.nzOrientation)("ant-divider-dashed",o.nzDashed)},inputs:{nzText:"nzText",nzType:"nzType",nzOrientation:"nzOrientation",nzDashed:"nzDashed",nzPlain:"nzPlain"},exportAs:["nzDivider"],standalone:!0,features:[t.jDz],decls:1,vars:1,consts:[["class","ant-divider-inner-text",4,"ngIf"],[1,"ant-divider-inner-text"],[4,"nzStringTemplateOutlet"]],template:function(n,o){1&n&&t.YNc(0,ke,2,1,"span",0),2&n&&t.Q6J("ngIf",o.nzText)},dependencies:[p.O5,nt.T,nt.f],encapsulation:2,changeDetection:0})}return(0,T.gn)([(0,E.yF)()],i.prototype,"nzDashed",void 0),(0,T.gn)([(0,E.yF)()],i.prototype,"nzPlain",void 0),i})(),Ee=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[it]})}return i})();var Ze=r(6494),Ae=r(2669),M=r(551),P=r(2438),O=r(8645),ot=r(2181),Q=r(8180),at=r(6236),Se=r(4194),I=r(3651),we=r(6593),De=r(8484),S=r(6028);const Fe=["imgRef"],Ne=["imagePreviewWrapper"];function Me(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"li",10),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.KtG(a.onClick())}),t._UZ(1,"span",11),t.qZA()}if(2&i){const e=s.$implicit,n=t.oxw();t.ekj("ant-image-preview-operations-operation-disabled",n.zoomOutDisabled&&"zoomOut"===e.type),t.xp6(1),t.Q6J("nzType",e.icon)}}function Pe(i,s){if(1&i&&t._UZ(0,"img",13,14),2&i){const e=t.oxw().$implicit,n=t.oxw();t.Udp("width",e.width)("height",e.height)("transform",n.previewImageTransform),t.uIk("src",n.sanitizerResourceUrl(e.src),t.LSH)("srcset",e.srcset)("alt",e.alt)}}function Oe(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Pe,2,9,"img",12),t.BQk()),2&i){const e=s.index,n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.index===e)}}function Ie(i,s){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",15),t.NdJ("click",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSwitchLeft(o))}),t._UZ(2,"span",16),t.qZA(),t.TgZ(3,"div",17),t.NdJ("click",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSwitchRight(o))}),t._UZ(4,"span",18),t.qZA(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(1),t.ekj("ant-image-preview-switch-left-disabled",e.index<=0),t.xp6(2),t.ekj("ant-image-preview-switch-right-disabled",e.index>=e.images.length-1)}}const Ue=["*"];function rt(i,s,e){const n=i+s,o=(s-e)/2;let a=null;return s>e?(i>0&&(a=o),i<0&&n<e&&(a=-o)):(i<0||n>e)&&(a=i<0?o:-o),a}class ${constructor(){this.nzKeyboard=!0,this.nzNoAnimation=!1,this.nzMaskClosable=!0,this.nzCloseOnNavigation=!0}}const Y={x:0,y:0};let lt=(()=>{class i{get animationDisabled(){return this.config.nzNoAnimation??!1}get maskClosable(){const e=this.nzConfigService.getConfigForComponent("image")||{};return this.config.nzMaskClosable??e.nzMaskClosable??!0}constructor(e,n,o,a,l,_,x,ft){this.ngZone=e,this.host=n,this.cdr=o,this.nzConfigService=a,this.config=l,this.overlayRef=_,this.destroy$=x,this.sanitizer=ft,this._defaultNzZoom=1,this._defaultNzScaleStep=.5,this._defaultNzRotate=0,this.images=[],this.index=0,this.isDragging=!1,this.visible=!0,this.animationState="enter",this.animationStateChanged=new t.vpe,this.scaleStepMap=new Map,this.previewImageTransform="",this.previewImageWrapperTransform="",this.operations=[{icon:"close",onClick:()=>{this.onClose()},type:"close"},{icon:"zoom-in",onClick:()=>{this.onZoomIn()},type:"zoomIn"},{icon:"zoom-out",onClick:()=>{this.onZoomOut()},type:"zoomOut"},{icon:"rotate-right",onClick:()=>{this.onRotateRight()},type:"rotateRight"},{icon:"rotate-left",onClick:()=>{this.onRotateLeft()},type:"rotateLeft"}],this.zoomOutDisabled=!1,this.position={...Y},this.containerClick=new t.vpe,this.closeClick=new t.vpe,this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.updateZoomOutDisabled(),this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform()}ngOnInit(){this.ngZone.runOutsideAngular(()=>{(0,P.R)(this.host.nativeElement,"click").pipe((0,y.R)(this.destroy$)).subscribe(e=>{e.target===e.currentTarget&&this.maskClosable&&this.containerClick.observers.length&&this.ngZone.run(()=>this.containerClick.emit())}),(0,P.R)(this.imagePreviewWrapper.nativeElement,"mousedown").pipe((0,y.R)(this.destroy$)).subscribe(()=>{this.isDragging=!0})})}setImages(e,n){n&&(this.scaleStepMap=n),this.images=e,this.cdr.markForCheck()}switchTo(e){this.index=e,this.cdr.markForCheck()}next(){this.index<this.images.length-1&&(this.reset(),this.index++,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.cdr.markForCheck())}prev(){this.index>0&&(this.reset(),this.index--,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.cdr.markForCheck())}markForCheck(){this.cdr.markForCheck()}onClose(){this.closeClick.emit()}onZoomIn(){const e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom+=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled(),this.position={...Y}}onZoomOut(){if(this.zoom>1){const e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom-=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled(),this.position={...Y}}}onRotateRight(){this.rotate+=90,this.updatePreviewImageTransform()}onRotateLeft(){this.rotate-=90,this.updatePreviewImageTransform()}onSwitchLeft(e){e.preventDefault(),e.stopPropagation(),this.prev()}onSwitchRight(e){e.preventDefault(),e.stopPropagation(),this.next()}onAnimationStart(e){"enter"===e.toState?this.setEnterAnimationClass():"leave"===e.toState&&this.setLeaveAnimationClass(),this.animationStateChanged.emit(e)}onAnimationDone(e){"enter"===e.toState?this.setEnterAnimationClass():"leave"===e.toState&&this.setLeaveAnimationClass(),this.animationStateChanged.emit(e)}startLeaveAnimation(){this.animationState="leave",this.cdr.markForCheck()}onDragReleased(){this.isDragging=!1;const e=this.imageRef.nativeElement.offsetWidth*this.zoom,n=this.imageRef.nativeElement.offsetHeight*this.zoom,{left:o,top:a}=function Je(i){const s=i.getBoundingClientRect(),e=document.documentElement;return{left:s.left+(window.pageXOffset||e.scrollLeft)-(e.clientLeft||document.body.clientLeft||0),top:s.top+(window.pageYOffset||e.scrollTop)-(e.clientTop||document.body.clientTop||0)}}(this.imageRef.nativeElement),{width:l,height:_}=function Qe(){return{width:document.documentElement.clientWidth,height:window.innerHeight||document.documentElement.clientHeight}}(),x=this.rotate%180!=0,q=function Be(i){let s={};return i.width<=i.clientWidth&&i.height<=i.clientHeight&&(s={x:0,y:0}),(i.width>i.clientWidth||i.height>i.clientHeight)&&(s={x:rt(i.left,i.width,i.clientWidth),y:rt(i.top,i.height,i.clientHeight)}),s}({width:x?n:e,height:x?e:n,left:o,top:a,clientWidth:l,clientHeight:_});((0,E.DX)(q.x)||(0,E.DX)(q.y))&&(this.position={...this.position,...q})}sanitizerResourceUrl(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}updatePreviewImageTransform(){this.previewImageTransform=`scale3d(${this.zoom}, ${this.zoom}, 1) rotate(${this.rotate}deg)`}updatePreviewImageWrapperTransform(){this.previewImageWrapperTransform=`translate3d(${this.position.x}px, ${this.position.y}px, 0)`}updateZoomOutDisabled(){this.zoomOutDisabled=this.zoom<=1}setEnterAnimationClass(){if(this.animationDisabled)return;const e=this.overlayRef.backdropElement;e&&(e.classList.add("ant-fade-enter"),e.classList.add("ant-fade-enter-active"))}setLeaveAnimationClass(){if(this.animationDisabled)return;const e=this.overlayRef.backdropElement;e&&(e.classList.add("ant-fade-leave"),e.classList.add("ant-fade-leave-active"))}reset(){this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.position={...Y}}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(t.R0b),t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(C.jY),t.Y36($),t.Y36(I.Iu),t.Y36(N.kn),t.Y36(we.H7))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["nz-image-preview"]],viewQuery:function(n,o){if(1&n&&(t.Gf(Fe,5),t.Gf(Ne,7)),2&n){let a;t.iGM(a=t.CRH())&&(o.imageRef=a.first),t.iGM(a=t.CRH())&&(o.imagePreviewWrapper=a.first)}},hostAttrs:["tabindex","-1","role","document",1,"ant-image-preview-wrap"],hostVars:6,hostBindings:function(n,o){1&n&&t.WFA("@fadeMotion.start",function(l){return o.onAnimationStart(l)})("@fadeMotion.done",function(l){return o.onAnimationDone(l)}),2&n&&(t.d8E("@.disabled",o.config.nzNoAnimation)("@fadeMotion",o.animationState),t.Udp("z-index",o.config.nzZIndex),t.ekj("ant-image-preview-moving",o.isDragging))},exportAs:["nzImagePreview"],standalone:!0,features:[t._Bn([N.kn]),t.jDz],decls:11,vars:6,consts:[[1,"ant-image-preview"],["tabindex","0","aria-hidden","true",2,"width","0","height","0","overflow","hidden","outline","none"],[1,"ant-image-preview-content"],[1,"ant-image-preview-body"],[1,"ant-image-preview-operations"],["class","ant-image-preview-operations-operation",3,"ant-image-preview-operations-operation-disabled","click",4,"ngFor","ngForOf"],["cdkDrag","",1,"ant-image-preview-img-wrapper",3,"cdkDragFreeDragPosition","cdkDragReleased"],["imagePreviewWrapper",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"ant-image-preview-operations-operation",3,"click"],["nz-icon","","nzTheme","outline",1,"ant-image-preview-operations-icon",3,"nzType"],["cdkDragHandle","","class","ant-image-preview-img",3,"width","height","transform",4,"ngIf"],["cdkDragHandle","",1,"ant-image-preview-img"],["imgRef",""],[1,"ant-image-preview-switch-left",3,"click"],["nz-icon","","nzType","left","nzTheme","outline"],[1,"ant-image-preview-switch-right",3,"click"],["nz-icon","","nzType","right","nzTheme","outline"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2)(3,"div",3)(4,"ul",4),t.YNc(5,Me,2,3,"li",5),t.qZA(),t.TgZ(6,"div",6,7),t.NdJ("cdkDragReleased",function(){return o.onDragReleased()}),t.YNc(8,Oe,2,1,"ng-container",8),t.qZA(),t.YNc(9,Ie,5,4,"ng-container",9),t.qZA()(),t._UZ(10,"div",1),t.qZA()),2&n&&(t.xp6(5),t.Q6J("ngForOf",o.operations),t.xp6(1),t.Udp("transform",o.previewImageWrapperTransform),t.Q6J("cdkDragFreeDragPosition",o.position),t.xp6(2),t.Q6J("ngForOf",o.images),t.xp6(1),t.Q6J("ngIf",o.images.length>1))},dependencies:[p.sg,M.PV,M.Ls,at.Bh,at.Zt,p.O5],encapsulation:2,data:{animation:[Se.MC]},changeDetection:0})}return i})();class qe{constructor(s,e,n){this.previewInstance=s,this.config=e,this.overlayRef=n,this.destroy$=new O.x,n.keydownEvents().pipe((0,ot.h)(o=>this.config.nzKeyboard&&(o.keyCode===S.hY||o.keyCode===S.oh||o.keyCode===S.SV)&&!(0,S.Vb)(o))).subscribe(o=>{o.preventDefault(),o.keyCode===S.hY&&this.close(),o.keyCode===S.oh&&this.prev(),o.keyCode===S.SV&&this.next()}),n.detachments().subscribe(()=>{this.overlayRef.dispose()}),s.containerClick.pipe((0,Q.q)(1),(0,y.R)(this.destroy$)).subscribe(()=>{this.close()}),s.closeClick.pipe((0,Q.q)(1),(0,y.R)(this.destroy$)).subscribe(()=>{this.close()}),s.animationStateChanged.pipe((0,ot.h)(o=>"done"===o.phaseName&&"leave"===o.toState),(0,Q.q)(1)).subscribe(()=>{this.dispose()})}switchTo(s){this.previewInstance.switchTo(s)}next(){this.previewInstance.next()}prev(){this.previewInstance.prev()}close(){this.previewInstance.startLeaveAnimation()}dispose(){this.destroy$.next(),this.overlayRef.dispose()}}let ct=(()=>{class i{constructor(e,n,o,a){this.overlay=e,this.injector=n,this.nzConfigService=o,this.directionality=a}preview(e,n,o){return this.display(e,n,o)}display(e,n,o){const a={...new $,...n??{}},l=this.createOverlay(a),_=this.attachPreviewComponent(l,a);_.setImages(e,o);const x=new qe(_,a,l);return _.previewRef=x,x}attachPreviewComponent(e,n){const o=t.zs3.create({parent:this.injector,providers:[{provide:I.Iu,useValue:e},{provide:$,useValue:n}]}),a=new De.C5(lt,null,o);return e.attach(a).instance}createOverlay(e){const n=this.nzConfigService.getConfigForComponent("image")||{},o=new I.X_({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.overlay.position().global(),disposeOnNavigation:e.nzCloseOnNavigation??n.nzCloseOnNavigation??!0,backdropClass:"ant-image-preview-mask",direction:e.nzDirection||n.nzDirection||this.directionality.value});return this.overlay.create(o)}static#t=this.\u0275fac=function(n){return new(n||i)(t.LFG(I.aV),t.LFG(t.zs3),t.LFG(C.jY),t.LFG(B.Is,8))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac})}return i})(),He=(()=>{class i{constructor(){this.nzScaleStep=null,this.images=[]}addImage(e){this.images.push(e)}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["nz-image-group"]],inputs:{nzScaleStep:"nzScaleStep"},exportAs:["nzImageGroup"],standalone:!0,features:[t.jDz],ngContentSelectors:Ue,decls:1,vars:0,template:function(n,o){1&n&&(t.F$t(),t.Hsn(0))},encapsulation:2,changeDetection:0})}return i})(),je=(()=>{class i{get previewable(){return!this.nzDisablePreview&&"error"!==this.status}constructor(e,n,o,a,l,_,x){this.document=e,this.nzConfigService=n,this.elementRef=o,this.nzImageService=a,this.cdr=l,this.parentGroup=_,this.directionality=x,this._nzModuleName="image",this.nzSrc="",this.nzSrcset="",this.nzDisablePreview=!1,this.nzFallback=null,this.nzPlaceholder=null,this.nzScaleStep=null,this.status="normal",this.backLoadDestroy$=new O.x,this.destroy$=new O.x}ngOnInit(){this.backLoad(),this.parentGroup&&this.parentGroup.addImage(this),this.directionality&&(this.directionality.change?.pipe((0,y.R)(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPreview(){if(this.previewable)if(this.parentGroup){const e=this.parentGroup.images.filter(_=>_.previewable),n=e.map(_=>({src:_.nzSrc,srcset:_.nzSrcset})),o=e.findIndex(_=>this===_),a=new Map;e.forEach(_=>{a.set(_.nzSrc??_.nzSrcset,_.nzScaleStep??this.parentGroup.nzScaleStep??this.nzScaleStep??.5)}),this.nzImageService.preview(n,{nzDirection:this.dir},a).switchTo(o)}else this.nzImageService.preview([{src:this.nzSrc,srcset:this.nzSrcset}],{nzDirection:this.dir,nzScaleStep:this.nzScaleStep??.5})}getElement(){return this.elementRef}ngOnChanges(e){const{nzSrc:n}=e;n&&(this.getElement().nativeElement.src=n.currentValue,this.backLoad())}backLoad(){this.backLoadImage=this.document.createElement("img"),this.backLoadImage.src=this.nzSrc,this.backLoadImage.srcset=this.nzSrcset,this.status="loading",this.backLoadDestroy$.next(),this.backLoadDestroy$.complete(),this.backLoadDestroy$=new O.x,this.backLoadImage.complete?(this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset):(this.nzPlaceholder?(this.getElement().nativeElement.src=this.nzPlaceholder,this.getElement().nativeElement.srcset=""):(this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset),(0,P.R)(this.backLoadImage,"load").pipe((0,y.R)(this.backLoadDestroy$),(0,y.R)(this.destroy$)).subscribe(()=>{this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset}),(0,P.R)(this.backLoadImage,"error").pipe((0,y.R)(this.backLoadDestroy$),(0,y.R)(this.destroy$)).subscribe(()=>{this.status="error",this.nzFallback&&(this.getElement().nativeElement.src=this.nzFallback,this.getElement().nativeElement.srcset="")}))}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(p.K0),t.Y36(C.jY),t.Y36(t.SBq),t.Y36(ct),t.Y36(t.sBO),t.Y36(He,8),t.Y36(B.Is,8))};static#e=this.\u0275dir=t.lG2({type:i,selectors:[["img","nz-image",""]],hostBindings:function(n,o){1&n&&t.NdJ("click",function(){return o.onPreview()})},inputs:{nzSrc:"nzSrc",nzSrcset:"nzSrcset",nzDisablePreview:"nzDisablePreview",nzFallback:"nzFallback",nzPlaceholder:"nzPlaceholder",nzScaleStep:"nzScaleStep"},exportAs:["nzImage"],standalone:!0,features:[t.TTD]})}return(0,T.gn)([(0,E.yF)(),(0,C.oS)()],i.prototype,"nzDisablePreview",void 0),(0,T.gn)([(0,C.oS)()],i.prototype,"nzFallback",void 0),(0,T.gn)([(0,C.oS)()],i.prototype,"nzPlaceholder",void 0),(0,T.gn)([(0,C.oS)()],i.prototype,"nzScaleStep",void 0),i})(),Re=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({providers:[ct],imports:[lt]})}return i})();var We=r(855),Ke=r(1958);function Xe(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"nz-input-group",12)(1,"input",13),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.queryName=o)}),t.qZA()()}if(2&i){const e=t.oxw(),n=t.MAs(3);t.Q6J("nzAddOnAfter",n),t.xp6(1),t.Q6J("ngModel",e.queryName)}}function Ve(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.search())}),t._uU(1,"\u8df3\u8f6c"),t.qZA()}}function tn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.handleUpload())}),t._UZ(1,"i",16),t._uU(2,"\u4e0a\u4f20 "),t.qZA()}}function en(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.load())}),t._UZ(1,"i",17),t._uU(2," \u5237\u65b0 "),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("nzSpin",e.loading)}}function nn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handlePre())}),t._UZ(1,"span",20),t._uU(2," \u8fd4\u56de\u4e0a\u4e00\u7ea7\u76ee\u5f55 "),t.qZA()}}function on(i,s){1&i&&(t.ynx(0),t.YNc(1,nn,3,0,"button",18),t.BQk())}function an(i,s){1&i&&t._uU(0),2&i&&t.hij("\u603b\u5171 ",s.$implicit," \u6761")}function sn(i,s){1&i&&t._UZ(0,"img",29)}function rn(i,s){if(1&i&&t._UZ(0,"img",34),2&i){const e=t.oxw(2).$implicit,n=t.oxw();t.Q6J("nzSrc",n.handleSrc(e.name))}}function ln(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"video",35),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleOpenLink(o.name))}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,n=t.oxw();t.Q6J("src",n.handleSrc(e.name),t.LSH)}}function cn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"img",35),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.handleOpenLink(o.name))}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,n=t.oxw();t.Q6J("src","/assets/attach_icon/"+n.getMatched(e.mime)+".svg",t.LSH)}}function pn(i,s){if(1&i&&(t.TgZ(0,"div",30),t.YNc(1,rn,1,1,"img",31)(2,ln,1,1,"video",32)(3,cn,1,1,"img",33),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("ngSwitch",n.getMatched(e.mime)),t.xp6(1),t.Q6J("ngSwitchCase","image"),t.xp6(1),t.Q6J("ngSwitchCase","video")}}function un(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"span")(1,"a",36),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleRedictTo(o.name))}),t._uU(2),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.name)}}function dn(i,s){if(1&i&&t._uU(0),2&i){const e=t.oxw().$implicit;t.Oqu(e.name)}}function mn(i,s){if(1&i){const e=t.EpF();t._UZ(0,"nz-divider",26),t.TgZ(1,"a",27),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleCopy(o.name))}),t._uU(2," \u590d\u5236\u94fe\u63a5 "),t.qZA(),t._UZ(3,"nz-divider",26),t.TgZ(4,"a",27),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleDownLoad(o.name))}),t._uU(5," \u4e0b\u8f7d "),t.qZA()}}function hn(i,s){if(1&i){const e=t.EpF();t._UZ(0,"nz-divider",26),t.TgZ(1,"a",27),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleSelect(o.name))}),t._uU(2," \u9009\u62e9"),t.qZA()}}function _n(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t.YNc(2,sn,1,0,"img",21)(3,pn,4,3,"ng-template",null,22,t.W1O),t.qZA(),t.TgZ(5,"td"),t.YNc(6,un,3,1,"span",23)(7,dn,1,1,"ng-template",null,24,t.W1O),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"td")(15,"a",25),t.NdJ("nzOnConfirm",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.delete(a.name))})("nzOnCancel",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.cancel())}),t._uU(16," \u5220\u9664 "),t.qZA(),t._UZ(17,"nz-divider",26),t.TgZ(18,"a",27),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.handleRename(a.name))}),t._uU(19," \u91cd\u547d\u540d "),t.qZA(),t.YNc(20,mn,6,0,"ng-template",28)(21,hn,3,0,"ng-template",28),t.qZA()()}if(2&i){const e=s.$implicit,n=t.MAs(4),o=t.MAs(8),a=t.oxw();t.xp6(2),t.Q6J("ngIf",e.folder)("ngIfElse",n),t.xp6(4),t.Q6J("ngIf",e.folder)("ngIfElse",o),t.xp6(4),t.Oqu(e.mime||"\u6587\u4ef6\u5939"),t.xp6(2),t.Oqu(t.lcZ(13,8,e.time)),t.xp6(8),t.Q6J("ngIf",!e.folder),t.xp6(1),t.Q6J("ngIf",!e.folder&&a.fromIframe)}}let fn=(()=>{class i{constructor(e,n,o,a){this.rs=e,this.modal=n,this.msg=o,this.viewContainerRef=a,this.loading=!1,this.inputValue="",this.queryName="",this.datum=[],this.total=1,this.pageSize=20,this.pageIndex=1,this.query={},this.fromIframe=!0,this.load()}load(){this.loading=!0,this.rs.get("attach/list",{}).subscribe(e=>{const{data:n,total:o}=e;this.datum=n||[],this.total=o||0}).add(()=>{this.loading=!1})}delete(e,n){this.rs.get(`attach/remove/${this.queryName}/${e}`).subscribe(o=>{this.msg.success("\u5220\u9664\u6210\u529f"),this.load()})}cancel(){}search(){this.query.keyword={},this.query.skip=0,this.datum=[],this.inputValue=this.queryName,this.load()}handleRedictTo(e){this.queryName=this.queryName?`${this.queryName}/${e}`:e,this.search()}handleUpload(){this.modal.create({nzTitle:"\u4e0a\u4f20\u6587\u4ef6",nzContent:Te,nzViewContainerRef:this.viewContainerRef,nzData:{inputValue:this.queryName},nzFooter:null,nzOnCancel:({isSuccess:e})=>{e&&this.load()}})}handleRename(e){const n=this.modal.create({nzTitle:"\u91cd\u547d\u540d",nzContent:Ce,nzData:{currentName:e},nzViewContainerRef:this.viewContainerRef,nzFooter:[{label:"\u53d6\u6d88",onClick:()=>n.destroy()},{label:"\u4fdd\u5b58",type:"primary",onClick:()=>{const o=n.getContentComponent();this.rs.post(`attach/rename/${this.queryName?this.queryName+"/":""}${e}`,{name:o.name}).subscribe(a=>{this.msg.success("\u4fdd\u5b58\u6210\u529f"),n.destroy(),this.load()})}}]})}handleSrc(e){return`/attach/${this.inputValue?`${this.inputValue}/`:""}${e}`}handleOpenLink(e){window.open(this.handleSrc(e))}getMatched(e){const n=e.match(/image|video|word|powerpoint|excel|text|zip|pdf|html|flash|exe|xml|psd/g);return n?n[0]:"unknown"}handleCopy(e){const n=this.handleSrc(e);this.msg.success("\u590d\u5236\u6210\u529f");const o=document.createElement("input");o.value=n,o.setAttribute("readonly",""),document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}handlePre(){const e=this.queryName.split("/");e.pop(),this.queryName=e.join("/"),this.search()}handleDownLoad(e){const n=document.createElement("a"),o=new MouseEvent("click");n.download=e,n.href=this.handleSrc(e),n.dispatchEvent(o)}handleSelect(e){const n=this.handleSrc(e);console.log("\u{1f680} ~ file: attachment.component.ts:145 ~ AttachmentComponent ~ handleSelect ~ url:",n),window.top?.postMessage(n)}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(u.s),t.Y36(D.Sf),t.Y36(g.dD),t.Y36(t.s_b))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-setting-attach"]],standalone:!0,features:[t.jDz],decls:25,vars:9,consts:[["nzSearch","",3,"nzAddOnAfter",4,"nzSpaceItem"],["suffixButton",""],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],[4,"ngIf"],["totalTemplate",""],["nzShowPagination","","nzShowSizeChanger","",3,"nzData","nzLoading","nzTotal","nzShowTotal","nzPageSize","nzPageIndex"],["basicTable",""],["nzColumnKey","pre"],["nzColumnKey","name"],["nzColumnKey","mime"],["nzColumnKey","time",3,"nzSortFn"],[4,"ngFor","ngForOf"],["nzSearch","",3,"nzAddOnAfter"],["type","text","nz-input","","placeholder","\u5f53\u524d\u6240\u5904\u6587\u4ef6\u5939",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSearch","",3,"click"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus"],["nz-icon","","nzType","reload",3,"nzSpin"],["nz-button","",3,"click",4,"nzSpaceItem"],["nz-button","",3,"click"],["nz-icon","","nzType","rollback","nzTheme","outline"],["width","40px","src","/assets/fold.svg","alt","logo",4,"ngIf","ngIfElse"],["tpw",""],[4,"ngIf","ngIfElse"],["tpl",""],["nz-popconfirm","","nzPopconfirmTitle","\u786e\u5b9a\u5220\u9664?","nzPopconfirmPlacement","topLeft",3,"nzOnConfirm","nzOnCancel"],["nzType","vertical"],[3,"click"],[3,"ngIf"],["width","40px","src","/assets/fold.svg","alt","logo"],[3,"ngSwitch"],["nz-image","","width","50px",3,"nzSrc",4,"ngSwitchCase"],["width","50px",3,"src","click",4,"ngSwitchCase"],["width","50px",3,"src","click",4,"ngSwitchDefault"],["nz-image","","width","50px",3,"nzSrc"],["width","50px",3,"src","click"],["href","javascript:;",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-space"),t.YNc(1,Xe,2,2,"nz-input-group",0)(2,Ve,2,0,"ng-template",null,1,t.W1O)(4,tn,3,0,"button",2)(5,en,3,1,"button",2)(6,on,2,0,"ng-container",3),t.qZA(),t.YNc(7,an,1,1,"ng-template",null,4,t.W1O),t.TgZ(9,"nz-table",5,6)(11,"thead")(12,"tr")(13,"th",7),t._uU(14,"\u9884\u89c8"),t.qZA(),t.TgZ(15,"th",8),t._uU(16,"\u540d\u79f0"),t.qZA(),t.TgZ(17,"th",9),t._uU(18,"\u7c7b\u578b"),t.qZA(),t.TgZ(19,"th",10),t._uU(20,"\u65e5\u671f"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"\u64cd\u4f5c"),t.qZA()()(),t.TgZ(23,"tbody"),t.YNc(24,_n,22,10,"tr",11),t.qZA()()),2&n){const a=t.MAs(8),l=t.MAs(10);t.xp6(6),t.Q6J("ngIf",o.inputValue),t.xp6(3),t.Q6J("nzData",o.datum)("nzLoading",o.loading)("nzTotal",o.total)("nzShowTotal",a)("nzPageSize",o.pageSize)("nzPageIndex",o.pageIndex),t.xp6(10),t.Q6J("nzSortFn",!0),t.xp6(5),t.Q6J("ngForOf",l.data)}},dependencies:[Re,je,k._p,k.JW,D.Qp,d.sL,d.ix,We.w,Ke.dQ,p.ez,p.sg,p.O5,p.RF,p.n9,p.ED,p.uU,M.PV,M.Ls,Ae.j,v.HQ,v.N8,v.qD,v.Uo,v._C,v.Om,v.p0,v.$Z,J.cS,Ee,it,f.u5,f.Fj,f.JJ,f.On,Ze.m,Z.o7,Z.Zp,Z.gB,z.zf,z.NU,z.$1]})}return i})();var gn=r(2683),bn=r(6942),F=r(2078);const zn=["editor"];function vn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let yn=(()=>{class i{constructor(e,n){this.rs=e,this.ms=n,this.values={},this.fields=[{label:"",key:"properties",type:"table",children:[{label:"\u53d8\u91cf",key:"name",type:"text"},{label:"\u540d\u79f0",key:"label",type:"text"},{label:"\u7c7b\u578b",key:"type",type:"select",default:"int",options:[{label:"\u6574\u6570",value:"int"},{label:"\u6d6e\u70b9\u6570",value:"float"},{label:"\u5e03\u5c14\u578b",value:"bool"},{label:"\u5b57\u7b26\u4e32",value:"text"},{label:"\u6570\u7ec4",value:"array"},{label:"\u5bf9\u8c61",value:"object"}]},{label:"\u5355\u4f4d",key:"unit",type:"text"},{label:"\u6a21\u5f0f",key:"mode",type:"select",default:"r",options:[{label:"\u53ea\u8bfb",value:"r"},{label:"\u8bfb\u5199",value:"rw"}]}]}]}ngOnInit(){this.rs.get(`product/${this.product_id}/version/${this.version}/config/property`).subscribe(e=>{this.values={properties:e.data||[]}})}onSubmit(){this.rs.post(`product/${this.product_id}/version/${this.version}/config/property`,this.editor.value.properties).subscribe(n=>{this.ms.success("\u63d0\u793a","\u4fdd\u5b58\u6210\u529f")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(u.s),t.Y36(F.zb))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-property-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(zn,5),2&n){let a;t.iGM(a=t.CRH())&&(o.editor=a.first)}},inputs:{product_id:"product_id",version:"version"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u5c5e\u6027\u7f16\u8f91",3,"nzExtra"],[3,"fields","values"],["editor",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,vn,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[b.B,d.ix,m.bd]})}return i})();const Cn=["editor"];function Tn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let xn=(()=>{class i{constructor(e,n){this.rs=e,this.ms=n,this.arguments=[{label:"\u53d8\u91cf",key:"name",type:"text"},{label:"\u540d\u79f0",key:"label",type:"text"},{label:"\u7c7b\u578b",key:"type",type:"select",default:"int",options:[{label:"\u6574\u6570",value:"int"},{label:"\u6d6e\u70b9\u6570",value:"float"},{label:"\u5e03\u5c14\u578b",value:"bool"},{label:"\u5b57\u7b26\u4e32",value:"text"},{label:"\u6570\u7ec4",value:"array"},{label:"\u5bf9\u8c61",value:"object"}]}],this.values={},this.fields=[{label:"",key:"events",type:"list",children:[{label:"\u7b49\u7ea7",key:"level",type:"number"},{label:"\u4e8b\u4ef6",key:"name",type:"text"},{label:"\u540d\u79f0",key:"label",type:"text"},{label:"\u8f93\u51fa",key:"outputs",type:"table",children:this.arguments}]}]}ngOnInit(){this.rs.get(`product/${this.product_id}/version/${this.version}/config/event`).subscribe(e=>{this.values={events:e.data||[]}})}onSubmit(){this.rs.post(`product/${this.product_id}/version/${this.version}/config/event`,this.editor.value.events).subscribe(n=>{this.ms.success("\u63d0\u793a","\u4fdd\u5b58\u6210\u529f")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(u.s),t.Y36(F.zb))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-event-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(Cn,5),2&n){let a;t.iGM(a=t.CRH())&&(o.editor=a.first)}},inputs:{product_id:"product_id",version:"version"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u4e8b\u4ef6\u7f16\u8f91",3,"nzExtra"],[3,"fields","values"],["editor",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,Tn,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[b.B,d.ix,m.bd]})}return i})();const kn=["editor"];function En(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let Zn=(()=>{class i{constructor(e,n){this.rs=e,this.ms=n,this.arguments=[{label:"\u53d8\u91cf",key:"name",type:"text"},{label:"\u540d\u79f0",key:"label",type:"text"},{label:"\u7c7b\u578b",key:"type",type:"select",default:"int",options:[{label:"\u6574\u6570",value:"int"},{label:"\u6d6e\u70b9\u6570",value:"float"},{label:"\u5e03\u5c14\u578b",value:"bool"},{label:"\u5b57\u7b26\u4e32",value:"text"},{label:"\u6570\u7ec4",value:"array"},{label:"\u5bf9\u8c61",value:"object"}]}],this.values={},this.fields=[{label:"",key:"actions",type:"list",children:[{label:"\u52a8\u4f5c",key:"name",type:"text"},{label:"\u540d\u79f0",key:"label",type:"text"},{label:"\u5f02\u6b65",key:"async",type:"switch"},{label:"\u8f93\u5165",key:"inputs",type:"table",children:this.arguments},{label:"\u8f93\u51fa",key:"outputs",type:"table",children:this.arguments}]}]}ngOnInit(){this.rs.get(`product/${this.product_id}/version/${this.version}/config/action`).subscribe(e=>{this.values={actions:e.data||[]}})}onSubmit(){this.rs.post(`product/${this.product_id}/version/${this.version}/config/action`,this.editor.value.actions).subscribe(n=>{this.ms.success("\u63d0\u793a","\u4fdd\u5b58\u6210\u529f")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(u.s),t.Y36(F.zb))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-action-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(kn,5),2&n){let a;t.iGM(a=t.CRH())&&(o.editor=a.first)}},inputs:{product_id:"product_id",version:"version"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u52a8\u4f5c\u7f16\u8f91",3,"nzExtra"],[3,"fields","values"],["editor",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,En,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[b.B,d.ix,m.bd]})}return i})();const An=["editor"];function Sn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let wn=(()=>{class i{constructor(e,n){this.rs=e,this.ms=n,this.values={},this.fields=[{label:"",key:"mappers",type:"table",children:[]}]}ngOnInit(){this.rs.get(`product/${this.product_id}`).subscribe(e=>{this.rs.get(`protocol/${e.data.protocol}/mapper`).subscribe(o=>{this.fields[0].children=o.data,this.rs.get(`product/${this.product_id}/version/${this.version}/config/mapper`).subscribe(a=>{this.values={mappers:a.data||[]}})})})}onSubmit(){this.rs.post(`product/${this.product_id}/version/${this.version}/config/mapper`,this.editor.value.mappers).subscribe(n=>{this.ms.success("\u63d0\u793a","\u4fdd\u5b58\u6210\u529f")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(u.s),t.Y36(F.zb))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-mapper-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(An,5),2&n){let a;t.iGM(a=t.CRH())&&(o.editor=a.first)}},inputs:{product_id:"product_id",version:"version"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u6570\u636e\u6620\u5c04",3,"nzExtra"],[3,"fields","values"],["editor",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,Sn,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[d.ix,m.bd,b.B]})}return i})();const Dn=["editor"];function Fn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let Nn=(()=>{class i{constructor(e,n){this.rs=e,this.ms=n,this.values={},this.fields=[{label:"",key:"pollers",type:"table",children:[]}]}ngOnInit(){this.rs.get(`product/${this.product_id}`).subscribe(e=>{this.rs.get(`protocol/${e.data.protocol}/poller`).subscribe(o=>{this.fields[0].children=o.data,this.rs.get(`product/${this.product_id}/version/${this.version}/config/poller`).subscribe(a=>{this.values={pollers:a.data||[]}})})})}onSubmit(){this.rs.post(`product/${this.product_id}/version/${this.version}/config/poller`,this.editor.value.pollers).subscribe(n=>{this.ms.success("\u63d0\u793a","\u4fdd\u5b58\u6210\u529f")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(u.s),t.Y36(F.zb))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-poller-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(Dn,5),2&n){let a;t.iGM(a=t.CRH())&&(o.editor=a.first)}},inputs:{product_id:"product_id",version:"version"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[["nzTitle","\u6570\u636e\u8f6e\u8be2",3,"nzExtra"],[3,"fields","values"],["editor",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,Fn,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[d.ix,m.bd,b.B]})}return i})();function Mn(i,s){if(1&i&&t._UZ(0,"app-product-property-edit",8),2&i){const e=t.oxw();t.Q6J("product_id",e.id)("version",e.version)}}function Pn(i,s){if(1&i&&t._UZ(0,"app-product-event-edit",8),2&i){const e=t.oxw();t.Q6J("product_id",e.id)("version",e.version)}}function On(i,s){if(1&i&&t._UZ(0,"app-product-action-edit",8),2&i){const e=t.oxw();t.Q6J("product_id",e.id)("version",e.version)}}function In(i,s){if(1&i&&t._UZ(0,"app-product-mapper-edit",8),2&i){const e=t.oxw();t.Q6J("product_id",e.id)("version",e.version)}}function Un(i,s){if(1&i&&t._UZ(0,"app-product-poller-edit",8),2&i){const e=t.oxw();t.Q6J("product_id",e.id)("version",e.version)}}let Yn=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.value="",this.data={},this.fields=[{label:"ID",key:"id"},{label:"\u540d\u79f0",key:"name"},{label:"\u5173\u952e\u5b57",key:"keywords",type:"tags"},{label:"\u521b\u5efa\u65f6\u95f4",key:"created",type:"date"},{label:"\u8bf4\u660e",key:"description",span:2}]}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load()),this.route.snapshot.paramMap.has("version")&&(this.version=this.route.snapshot.paramMap.get("version"))}load(){this.rs.get(`product/${this.id}`,{}).subscribe(e=>{this.data=e.data})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-version-edit"]],standalone:!0,features:[t.jDz],decls:13,vars:2,consts:[["nzTitle","\u4ea7\u54c1\u7248\u672c\u7f16\u8f91"],[3,"fields","value"],["nzTitle","\u4ea7\u54c1\u5c5e\u6027"],["nz-tab",""],["nzTitle","\u4ea7\u54c1\u4e8b\u4ef6"],["nzTitle","\u4ea7\u54c1\u52a8\u4f5c"],["nzTitle","\u6570\u636e\u6620\u5c04"],["nzTitle","\u6570\u636e\u8f6e\u8be2"],[3,"product_id","version"]],template:function(n,o){1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-info",1),t.TgZ(2,"nz-tabset")(3,"nz-tab",2),t.YNc(4,Mn,1,2,"ng-template",3),t.qZA(),t.TgZ(5,"nz-tab",4),t.YNc(6,Pn,1,2,"ng-template",3),t.qZA(),t.TgZ(7,"nz-tab",5),t.YNc(8,On,1,2,"ng-template",3),t.qZA(),t.TgZ(9,"nz-tab",6),t.YNc(10,In,1,2,"ng-template",3),t.qZA(),t.TgZ(11,"nz-tab",7),t.YNc(12,Un,1,2,"ng-template",3),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("fields",o.fields)("value",o.data))},dependencies:[p.ez,A.E,m.bd,h.we,h.xH,h.xw,h.cj,yn,xn,Zn,wn,Nn]})}return i})();var Bn=r(8517);const Jn=()=>[];let pt=(()=>{class i{constructor(e,n){this.rs=e,this.ref=n,this.datum=[],this.total=0,this.loading=!1,this.buttons=[{icon:"plus",label:"\u521b\u5efa",link:()=>"/admin/server/create"}],this.columns=[{key:"id",sortable:!0,label:"ID",keyword:!0,link:o=>`/admin/server/${o.id}`},{key:"name",sortable:!0,label:"\u540d\u79f0",keyword:!0},{key:"port",sortable:!0,label:"\u7aef\u53e3",keyword:!0},{key:"created",sortable:!0,label:"\u521b\u5efa\u65f6\u95f4",date:!0}],this.columnsSelect=[{key:"id",label:"ID",keyword:!0},{key:"name",label:"\u540d\u79f0",keyword:!0},{key:"port",label:"\u7aef\u53e3",keyword:!0}],this.operators=[{icon:"edit",title:"\u7f16\u8f91",link:o=>`/admin/server/${o.id}/edit`},{icon:"delete",title:"\u5220\u9664",confirm:"\u786e\u8ba4\u5220\u9664\uff1f",action:o=>{this.rs.get(`server/${o.id}/delete`).subscribe(a=>this.refresh())}}],this.operatorsSelect=[{label:"\u9009\u62e9",action:o=>this.ref.close(o)}]}refresh(){this.search(this.query)}search(e){this.query=e,this.loading=!0,this.rs.post("server/search",e).subscribe(n=>{this.datum=n.data,this.total=n.total}).add(()=>this.loading=!1)}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(u.s),t.Y36(D.Lf,8))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-server"]],standalone:!0,features:[t.jDz],decls:1,vars:7,consts:[[3,"buttons","columns","operators","datum","total","loading","query"]],template:function(n,o){1&n&&(t.TgZ(0,"im-smart-table",0),t.NdJ("query",function(l){return o.search(l)}),t.qZA()),2&n&&t.Q6J("buttons",o.ref?t.DdM(6,Jn):o.buttons)("columns",o.ref?o.columnsSelect:o.columns)("operators",o.ref?o.operatorsSelect:o.operators)("datum",o.datum)("total",o.total)("loading",o.loading)},dependencies:[p.ez,Bn.L]})}return i})();const Qn=["form"];function $n(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let ut=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.protocols=[],this.fields=[{key:"id",label:"ID",type:"text",min:2,max:30,placeholder:"\u9009\u586b"},{key:"name",label:"\u540d\u79f0",type:"text",required:!0,default:"\u65b0\u670d\u52a1\u7aef"},{key:"port",label:"\u7aef\u53e3",type:"number",min:1,max:65535,default:6e4},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae",type:"select",options:this.protocols,change:l=>this.loadProtocolOptions(l)},{key:"protocol_options",label:"\u901a\u8baf\u534f\u8bae\u53c2\u6570",type:"object"},{key:"description",label:"\u8bf4\u660e",type:"textarea"}],this.values={}}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load()),this.loadProtocols()}load(){this.rs.get("server/"+this.id).subscribe(e=>{this.values=e.data,this.loadProtocolOptions(this.values.protocol_name)})}loadProtocols(){this.rs.get("protocol/list").subscribe(e=>{this.fields[3].options=e.data.map(n=>({value:n.name,label:n.label}))})}loadProtocolOptions(e){e&&this.rs.get(`protocol/${e}/option`).subscribe(n=>{this.fields[4].children=n.data,this.form.group.setControl("protocol_options",this.form.build(n.data,this.form.value.protocol_options))})}onSubmit(){this.form.valid?this.rs.post(`server/${this.id||"create"}`,this.form.value).subscribe(n=>{this.router.navigateByUrl("/admin/server/"+n.data.id),this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-server-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(Qn,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:4,consts:[[3,"nzTitle","nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,$n,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzTitle","\u670d\u52a1\u5668"+(o.id?"\u7f16\u8f91":"\u521b\u5efa"))("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();var dt=r(4827);function Gn(i,s){}function qn(i,s){1&i&&(t.TgZ(0,"button",10),t._uU(1,"\u7f16\u8f91"),t.qZA())}function Hn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("nzOnConfirm",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.delete())}),t._uU(1,"\u5220\u9664"),t.qZA()}}function Ln(i,s){1&i&&(t.TgZ(0,"nz-space"),t.YNc(1,qn,2,0,"button",8)(2,Hn,2,0,"button",9),t.qZA())}let jn=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.data={},this.fields=[{key:"id",label:"ID"},{key:"name",label:"\u540d\u79f0"},{key:"port",label:"\u7aef\u53e3"},{key:"disabled",label:"\u7981\u7528"},{key:"created",label:"\u521b\u5efa\u65f6\u95f4",type:"date"},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae"},{key:"description",label:"\u8bf4\u660e",span:2}]}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.load()}load(){this.rs.get(`server/${this.id}`).subscribe(e=>{this.data=e.data})}delete(){this.rs.get(`server/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529f"),this.router.navigateByUrl("/admin/server")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-server-detail"]],standalone:!0,features:[t.jDz],decls:9,vars:4,consts:[["nzTitle","\u670d\u52a1\u5668\u8be6\u60c5",3,"nzExtra"],[3,"fields","value"],["nzType","line"],["nzTitle","\u8fde\u63a5"],[3,"server_id"],["nzTitle","\u65e5\u5fd7"],["nz-tab",""],["extra",""],["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-info",1),t.TgZ(2,"nz-tabset",2)(3,"nz-tab",3),t._UZ(4,"app-link",4),t.qZA(),t.TgZ(5,"nz-tab",5),t.YNc(6,Gn,0,0,"ng-template",6),t.qZA()()(),t.YNc(7,Ln,3,0,"ng-template",null,7,t.W1O)),2&n){const a=t.MAs(8);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("value",o.data),t.xp6(3),t.Q6J("server_id",o.id)}},dependencies:[p.ez,h.xH,h.xw,h.cj,m.bd,A.E,z.NU,z.$1,d.ix,c.rH,k.JW,dt.N]})}return i})(),Rn=(()=>{class i{constructor(e,n){this.ms=e,this.rs=n,this.id="",this.server={},this.placeholder=""}ngOnInit(){}registerOnChange(e){this.onChange=e}registerOnTouched(e){}writeValue(e){this.id!==e&&(this.id=e,this.id&&this.load())}load(){console.log("load server",this.id),this.rs.get("server/"+this.id).subscribe(e=>{e.data&&(this.server=e.data)})}select(){this.ms.create({nzTitle:"\u9009\u62e9",nzContent:pt,nzData:this.data}).afterClose.subscribe(e=>{console.log(e),e&&(this.server=e,this.id=e.id,this.onChange(this.id))})}change(e){console.log("on change",e),this.id=e,this.onChange(e),this.load()}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(D.Sf),t.Y36(u.s))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-input-server"]],inputs:{data:"data",placeholder:"placeholder"},standalone:!0,features:[t._Bn([{provide:f.JU,useExisting:(0,t.Gpc)(()=>i),multi:!0}]),t.jDz],decls:5,vars:3,consts:[["nz-input","",3,"placeholder","value","change"],["box",""],["type","button","nz-button","",3,"click"]],template:function(n,o){if(1&n){const a=t.EpF();t.TgZ(0,"input",0,1),t.NdJ("change",function(){t.CHM(a);const _=t.MAs(1);return t.KtG(o.change(_.value))}),t.qZA(),t.TgZ(2,"button",2),t.NdJ("click",function(){return o.select()}),t._uU(3,"\u9009\u62e9"),t.qZA(),t._uU(4)}2&n&&(t.Q6J("placeholder",o.placeholder)("value",o.id),t.xp6(4),t.hij("\n",o.server.name,"\n"))},dependencies:[d.ix,Z.Zp]})}return i})();const Wn=["form"],Kn=["chooseServer"];function Xn(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}function Vn(i,s){1&i&&t._UZ(0,"app-input-server",6),2&i&&t.Q6J("formControl",s.control)}let mt=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.protocols=[],this.fields=[{key:"id",label:"ID",type:"text",min:2,max:30,placeholder:"\u9009\u586b"},{key:"name",label:"\u540d\u79f0",type:"text",required:!0},{key:"server_id",label:"\u670d\u52a1\u5668",type:"template"},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae",type:"select",options:this.protocols,change:l=>this.loadProtocolOptions(l)},{key:"protocol_options",label:"\u901a\u8baf\u534f\u8bae\u53c2\u6570",type:"object"},{key:"description",label:"\u8bf4\u660e",type:"textarea"}],this.values={}}ngAfterViewInit(){setTimeout(()=>{this.fields[2].template=this.chooseServer})}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load()),this.loadProtocols()}load(){this.rs.get("link/"+this.id).subscribe(e=>{this.values=e.data,this.loadProtocolOptions(this.values.protocol_name)})}loadProtocols(){this.rs.get("protocol/list").subscribe(e=>{this.fields[3].options=e.data.map(n=>({value:n.name,label:n.label}))})}loadProtocolOptions(e){e&&this.rs.get(`protocol/${e}/option`).subscribe(n=>{this.fields[4].children=n.data,this.form.group.setControl("protocol_options",this.form.build(n.data,this.form.value.protocol_options))})}onSubmit(){this.form.valid?this.rs.post(`link/${this.id||"create"}`,this.form.value).subscribe(n=>{this.router.navigateByUrl("/admin/link/"+n.data.id),this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-link-edit"]],viewQuery:function(n,o){if(1&n&&(t.Gf(Wn,5),t.Gf(Kn,5)),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first),t.iGM(a=t.CRH())&&(o.chooseServer=a.first)}},standalone:!0,features:[t.jDz],decls:7,vars:4,consts:[[3,"nzTitle","nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["chooseServer",""],["nz-button","","nzType","primary",3,"click"],[3,"formControl"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,Xn,2,0,"ng-template",null,3,t.W1O)(5,Vn,1,1,"ng-template",null,4,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzTitle","\u8fde\u63a5"+(o.id?"\u7f16\u8f91":"\u521b\u5efa"))("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,f.u5,f.JJ,f.UX,f.oH,d.ix,m.bd,b.B,Rn]})}return i})();function ti(i,s){}function ei(i,s){1&i&&(t.TgZ(0,"button",9),t._uU(1,"\u7f16\u8f91"),t.qZA())}function ni(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("nzOnConfirm",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.delete())}),t._uU(1,"\u5220\u9664"),t.qZA()}}function ii(i,s){1&i&&(t.TgZ(0,"nz-space"),t.YNc(1,ei,2,0,"button",7)(2,ni,2,0,"button",8),t.qZA())}let oi=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.data={},this.fields=[{key:"id",label:"ID"},{key:"server",label:"\u670d\u52a1\u5668",type:"link",link:()=>`/admin/server/${this.data.server_id}`},{key:"name",label:"\u540d\u79f0"},{key:"remote",label:"\u8fdc\u7a0b\u5730\u5740"},{key:"disabled",label:"\u7981\u7528"},{key:"created",label:"\u521b\u5efa\u65f6\u95f4",type:"date"},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae"},{key:"description",label:"\u8bf4\u660e",span:2}]}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.load()}load(){this.rs.get(`link/${this.id}`).subscribe(e=>{this.data=e.data})}delete(){this.rs.get(`link/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529f"),this.router.navigateByUrl("/admin/link")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-link-detail"]],standalone:!0,features:[t.jDz],decls:9,vars:4,consts:[["nzTitle","\u8fde\u63a5\u8be6\u60c5",3,"nzExtra"],[3,"fields","value"],["nzTitle","\u8bbe\u5907"],[3,"tunnel_id"],["nzTitle","\u65e5\u5fd7"],["nz-tab",""],["extra",""],["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-info",1),t.TgZ(2,"nz-tabset")(3,"nz-tab",2),t._UZ(4,"app-devices",3),t.qZA(),t.TgZ(5,"nz-tab",4),t.YNc(6,ti,0,0,"ng-template",5),t.qZA()()(),t.YNc(7,ii,3,0,"ng-template",null,6,t.W1O)),2&n){const a=t.MAs(8);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("value",o.data),t.xp6(3),t.Q6J("tunnel_id",o.id)}},dependencies:[p.ez,h.xH,h.xw,h.cj,m.bd,A.E,z.NU,z.$1,d.ix,c.rH,k.JW,w.Z]})}return i})();var ai=r(7080);const si=["form"];function ri(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let ht=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.ports=[],this.protocols=[],this.fields=[{key:"id",label:"ID",type:"text",min:2,max:30,placeholder:"\u9009\u586b"},{key:"name",label:"\u540d\u79f0",type:"text",required:!0,default:"\u65b0\u4e32\u53e3"},{key:"port_name",label:"\u7aef\u53e3",type:"select",options:this.ports},{key:"baud_rate",label:"\u6ce2\u7279\u7387",type:"select",default:9600,options:[{label:"150",value:150},{label:"200",value:200},{label:"300",value:300},{label:"600",value:600},{label:"1200",value:1200},{label:"1800",value:1800},{label:"2400",value:2400},{label:"4800",value:4800},{label:"9600",value:9600},{label:"19200",value:19200},{label:"38400",value:38400},{label:"57600",value:57600},{label:"115200",value:115200}]},{key:"parity_mode",label:"\u5947\u5076\u6821\u9a8c",type:"select",options:[{label:"\u65e0\u6821\u9a8c NONE",value:0},{label:"\u5947\u6821\u9a8c ODD",value:1},{label:"\u5076\u6821\u9a8c EVEN",value:2},{label:"1\u6821\u9a8c MARK",value:3},{label:"0\u6821\u9a8c SPACE",value:4}]},{key:"stop_bits",label:"\u505c\u6b62\u4f4d",type:"select",options:[{label:"1",value:1},{label:"1.5",value:1.5,disabled:!0},{label:"2",value:2}]},{key:"data_bits",label:"\u5b57\u957f",type:"select",options:[{label:"5",value:5},{label:"6",value:6},{label:"7",value:7},{label:"8",value:8}],default:8},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae",type:"select",options:this.protocols,change:l=>this.loadProtocolOptions(l)},{key:"protocol_options",label:"\u901a\u8baf\u534f\u8bae\u53c2\u6570",type:"object"},{key:"description",label:"\u8bf4\u660e",type:"textarea"}],this.values={}}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load()),this.loadPorts(),this.loadProtocols()}load(){this.rs.get("serial/"+this.id).subscribe(e=>{this.values=e.data,this.loadProtocolOptions(this.values.protocol_name)})}loadPorts(){this.rs.get("serial/ports").subscribe(e=>{this.fields[2].options=e.data.map(n=>({value:n,label:n}))})}loadProtocols(){this.rs.get("protocol/list").subscribe(e=>{this.fields[7].options=e.data.map(n=>({value:n.name,label:n.label}))})}loadProtocolOptions(e){e&&this.rs.get(`protocol/${e}/option`).subscribe(n=>{this.fields[8].children=n.data,this.form.group.setControl("protocol_options",this.form.build(n.data,this.form.value.protocol_options))})}onSubmit(){this.form.valid?this.rs.post(`serial/${this.id||"create"}`,this.form.value).subscribe(n=>{this.router.navigateByUrl("/admin/serial/"+n.data.id),this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-serial-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(si,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:4,consts:[[3,"nzTitle","nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,ri,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzTitle","\u4e32\u53e3"+(o.id?"\u7f16\u8f91":"\u521b\u5efa"))("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();function li(i,s){}function ci(i,s){1&i&&(t.TgZ(0,"button",9),t._uU(1,"\u7f16\u8f91"),t.qZA())}function pi(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("nzOnConfirm",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.delete())}),t._uU(1,"\u5220\u9664"),t.qZA()}}function ui(i,s){1&i&&(t.TgZ(0,"nz-space"),t.YNc(1,ci,2,0,"button",7)(2,pi,2,0,"button",8),t.qZA())}let di=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.data={},this.fields=[{key:"id",label:"ID"},{key:"name",label:"\u540d\u79f0"},{key:"net",label:"\u7f51\u7edc"},{key:"addr",label:"\u5730\u5740"},{key:"port_name",label:"\u7aef\u53e3"},{key:"disabled",label:"\u7981\u7528"},{key:"created",label:"\u521b\u5efa\u65f6\u95f4",type:"date"},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae"},{key:"baud_rate",label:"\u6ce2\u7279\u7387"},{key:"parity_mode",label:"\u5947\u5076\u6821\u9a8c",type:"select",options:["\u65e0\u6821\u9a8c NONE","\u5947\u6821\u9a8c ODD","\u5076\u6821\u9a8c EVEN","1\u6821\u9a8c MARK","0\u6821\u9a8c SPACE"]},{key:"stop_bits",label:"\u505c\u6b62\u4f4d"},{key:"data_bits",label:"\u5b57\u957f"},{key:"description",label:"\u8bf4\u660e",span:2}]}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.load()}load(){this.rs.get(`serial/${this.id}`).subscribe(e=>{this.data=e.data})}delete(){this.rs.get(`client/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529f"),this.router.navigateByUrl("/admin/client")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-serial-detail"]],standalone:!0,features:[t.jDz],decls:9,vars:4,consts:[["nzTitle","\u4e32\u53e3\u8be6\u60c5",3,"nzExtra"],[3,"fields","value"],["nzTitle","\u8bbe\u5907"],[3,"tunnel_id"],["nzTitle","\u65e5\u5fd7"],["nz-tab",""],["extra",""],["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-info",1),t.TgZ(2,"nz-tabset")(3,"nz-tab",2),t._UZ(4,"app-devices",3),t.qZA(),t.TgZ(5,"nz-tab",4),t.YNc(6,li,0,0,"ng-template",5),t.qZA()()(),t.YNc(7,ui,3,0,"ng-template",null,6,t.W1O)),2&n){const a=t.MAs(8);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("value",o.data),t.xp6(3),t.Q6J("tunnel_id",o.id)}},dependencies:[p.ez,h.xH,h.xw,h.cj,m.bd,A.E,z.NU,z.$1,d.ix,c.rH,k.JW,w.Z]})}return i})();var mi=r(6787);const hi=["form"];function _i(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t._uU(1,"\u4fdd\u5b58"),t.qZA()}}let _t=(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.protocols=[],this.fields=[{key:"id",label:"ID",type:"text",min:2,max:30,placeholder:"\u9009\u586b"},{key:"name",label:"\u540d\u79f0",type:"text",required:!0,default:"\u65b0\u5ba2\u6237\u7aef"},{key:"net",label:"\u7f51\u7edc",type:"select",default:"tcp",options:[{label:"TCP",value:"tcp"},{label:"UDP",value:"udp"}]},{key:"addr",label:"\u5730\u5740",type:"text"},{key:"port",label:"\u7aef\u53e3",type:"number",min:1,max:65535},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae",type:"select",options:this.protocols,change:l=>this.loadProtocolOptions(l)},{key:"protocol_options",label:"\u901a\u8baf\u534f\u8bae\u53c2\u6570",type:"object"},{key:"description",label:"\u8bf4\u660e",type:"textarea"}],this.values={}}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load()),this.loadProtocols()}load(){this.rs.get("client/"+this.id).subscribe(e=>{this.values=e.data,this.loadProtocolOptions(this.values.protocol_name)})}loadProtocols(){this.rs.get("protocol/list").subscribe(e=>{this.fields[5].options=e.data.map(n=>({value:n.name,label:n.label}))})}loadProtocolOptions(e){e&&this.rs.get(`protocol/${e}/option`).subscribe(n=>{this.fields[6].children=n.data,this.form.group.setControl("protocol_options",this.form.build(n.data,this.form.value.protocol_options))})}onSubmit(){this.form.valid?this.rs.post(`client/${this.id||"create"}`,this.form.value).subscribe(n=>{this.router.navigateByUrl("/admin/client/"+n.data.id),this.msg.success("\u4fdd\u5b58\u6210\u529f")}):this.msg.error("\u8bf7\u68c0\u67e5\u6570\u636e")}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-client-edit"]],viewQuery:function(n,o){if(1&n&&t.Gf(hi,5),2&n){let a;t.iGM(a=t.CRH())&&(o.form=a.first)}},standalone:!0,features:[t.jDz],decls:5,vars:4,consts:[[3,"nzTitle","nzExtra"],[3,"fields","values"],["form",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-editor",1,2),t.qZA(),t.YNc(3,_i,2,0,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(4);t.Q6J("nzTitle","\u5ba2\u6237\u7aef"+(o.id?"\u7f16\u8f91":"\u521b\u5efa"))("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("values",o.values)}},dependencies:[p.ez,d.ix,m.bd,b.B]})}return i})();function fi(i,s){}function gi(i,s){1&i&&(t.TgZ(0,"button",9),t._uU(1,"\u7f16\u8f91"),t.qZA())}function bi(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("nzOnConfirm",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.delete())}),t._uU(1,"\u5220\u9664"),t.qZA()}}function zi(i,s){1&i&&(t.TgZ(0,"nz-space"),t.YNc(1,gi,2,0,"button",7)(2,bi,2,0,"button",8),t.qZA())}const yi=[{path:"",pathMatch:"full",redirectTo:"dash"},{path:"dash",component:Et,title:"\u63a7\u5236\u53f0",data:{breadcrumb:"\u63a7\u5236\u53f0"}},{path:"product",component:Zt.P,title:"\u4ea7\u54c1\u5217\u8868",data:{breadcrumb:"\u4ea7\u54c1\u5217\u8868"}},{path:"product/create",component:j,title:"\u521b\u5efa\u4ea7\u54c1",data:{breadcrumb:"\u521b\u5efa\u4ea7\u54c1"}},{path:"product/:id",component:Bt,title:"\u4ea7\u54c1\u8be6\u60c5",data:{breadcrumb:"\u4ea7\u54c1\u8be6\u60c5"}},{path:"product/:id/edit",component:j,title:"\u7f16\u8f91\u4ea7\u54c1",data:{breadcrumb:"\u7f16\u8f91\u4ea7\u54c1"}},{path:"product/:id/version",component:R.P,title:"\u4ea7\u54c1\u7248\u672c",data:{breadcrumb:"\u4ea7\u54c1\u7248\u672c"}},{path:"product/:id/version/:version",component:Yn,title:"\u4ea7\u54c1\u7248\u672c\u8be6\u60c5",data:{breadcrumb:"\u4ea7\u54c1\u7248\u672c\u8be6\u60c5"}},{path:"device",component:w.Z,title:"\u8bbe\u5907\u5217\u8868",data:{breadcrumb:"\u8bbe\u5907\u5217\u8868"}},{path:"device/create",component:K.C,title:"\u521b\u5efa\u8bbe\u5907",data:{breadcrumb:"\u521b\u5efa\u8bbe\u5907"}},{path:"device/:id",component:Jt.q,title:"\u8bbe\u5907\u8be6\u60c5",data:{breadcrumb:"\u8bbe\u5907\u8be6\u60c5"}},{path:"device/:id/edit",component:K.C,title:"\u7f16\u8f91\u8bbe\u5907",data:{breadcrumb:"\u7f16\u8f91\u8bbe\u5907"}},{path:"gateway",component:Qt.X,title:"\u7f51\u5173\u5217\u8868",data:{breadcrumb:"\u7f51\u5173\u5217\u8868"}},{path:"gateway/create",component:X,title:"\u521b\u5efa\u7f51\u5173",data:{breadcrumb:"\u521b\u5efa\u7f51\u5173"}},{path:"gateway/:id",component:Wt,title:"\u7f51\u5173\u8be6\u60c5",data:{breadcrumb:"\u7f51\u5173\u8be6\u60c5"}},{path:"gateway/:id/edit",component:X,title:"\u7f16\u8f91\u7f51\u5173",data:{breadcrumb:"\u7f16\u8f91\u7f51\u5173"}},{path:"project",component:Kt.v,title:"\u9879\u76ee\u5217\u8868",data:{breadcrumb:"\u9879\u76ee\u5217\u8868"}},{path:"project/create",component:V.Y,title:"\u521b\u5efa\u9879\u76ee",data:{breadcrumb:"\u521b\u5efa\u9879\u76ee"}},{path:"project/:id",component:Xt._,title:"\u9879\u76ee\u8be6\u60c5",data:{breadcrumb:"\u9879\u76ee\u8be6\u60c5"}},{path:"project/:id/edit",component:V.Y,title:"\u7f16\u8f91\u9879\u76ee",data:{breadcrumb:"\u7f16\u8f91\u9879\u76ee"}},{path:"project/:id/user",component:gn.p,title:"\u7ed1\u5b9a\u7528\u6237",data:{breadcrumb:"\u7ed1\u5b9a\u7528\u6237"}},{path:"space",component:Vt.v,title:"\u7a7a\u95f4\u5217\u8868",data:{breadcrumb:"\u7a7a\u95f4\u5217\u8868"}},{path:"space/create",component:tt.e,title:"\u521b\u5efa\u7a7a\u95f4",data:{breadcrumb:"\u521b\u5efa\u7a7a\u95f4"}},{path:"space/:id",component:te.o,title:"\u7a7a\u95f4\u8be6\u60c5",data:{breadcrumb:"\u7a7a\u95f4\u8be6\u60c5"}},{path:"space/:id/edit",component:tt.e,title:"\u7a7a\u95f4\u7f16\u8f91",data:{breadcrumb:"\u7a7a\u95f4\u7f16\u8f91"}},{path:"space/:id/device",component:bn.y,title:"\u7ed1\u5b9a\u8bbe\u5907",data:{breadcrumb:"\u7ed1\u5b9a\u8bbe\u5907"}},{path:"server",component:pt,title:"TCP\u670d\u52a1\u5668\u5217\u8868",data:{breadcrumb:"TCP\u670d\u52a1\u5668\u5217\u8868"}},{path:"server/create",component:ut,title:"\u521b\u5efaTCP\u670d\u52a1\u5668",data:{breadcrumb:"\u521b\u5efaTCP\u670d\u52a1\u5668"}},{path:"server/:id",component:jn,title:"TCP\u670d\u52a1\u5668\u8be6\u60c5",data:{breadcrumb:"TCP\u670d\u52a1\u5668\u8be6\u60c5"}},{path:"server/:id/edit",component:ut,title:"TCP\u670d\u52a1\u5668\u7f16\u8f91",data:{breadcrumb:"TCP\u670d\u52a1\u5668\u7f16\u8f91"}},{path:"link",component:dt.N,title:"TCP\u8fde\u63a5\u5217\u8868",data:{breadcrumb:"TCP\u8fde\u63a5\u5217\u8868"}},{path:"link/create",component:mt,title:"\u521b\u5efaTCP\u8fde\u63a5",data:{breadcrumb:"\u521b\u5efaTCP\u8fde\u63a5"}},{path:"link/:id",component:oi,title:"TCP\u8fde\u63a5\u8be6\u60c5",data:{breadcrumb:"TCP\u8fde\u63a5\u8be6\u60c5"}},{path:"link/:id/edit",component:mt,title:"TCP\u8fde\u63a5\u7f16\u8f91",data:{breadcrumb:"TCP\u8fde\u63a5\u7f16\u8f91"}},{path:"serial",component:ai.U,title:"\u4e32\u53e3\u5217\u8868",data:{breadcrumb:"\u4e32\u53e3\u5217\u8868"}},{path:"serial/create",component:ht,title:"\u521b\u5efa\u4e32\u53e3",data:{breadcrumb:"\u521b\u5efa\u4e32\u53e3"}},{path:"serial/:id",component:di,title:"\u4e32\u53e3\u8be6\u60c5",data:{breadcrumb:"\u4e32\u53e3\u8be6\u60c5"}},{path:"serial/:id/edit",component:ht,title:"\u4e32\u53e3\u7f16\u8f91",data:{breadcrumb:"\u4e32\u53e3\u7f16\u8f91"}},{path:"client",component:mi.H,title:"\u5ba2\u6237\u7aef\u5217\u8868",data:{breadcrumb:"\u5ba2\u6237\u7aef\u5217\u8868"}},{path:"client/create",component:_t,title:"\u521b\u5efa\u5ba2\u6237\u7aef",data:{breadcrumb:"\u521b\u5efa\u5ba2\u6237\u7aef"}},{path:"client/:id",component:(()=>{class i{constructor(e,n,o,a){this.router=e,this.msg=n,this.rs=o,this.route=a,this.id="",this.data={},this.fields=[{key:"id",label:"ID"},{key:"name",label:"\u540d\u79f0"},{key:"net",label:"\u7f51\u7edc"},{key:"addr",label:"\u5730\u5740"},{key:"port",label:"\u7aef\u53e3"},{key:"disabled",label:"\u7981\u7528"},{key:"created",label:"\u521b\u5efa\u65f6\u95f4",type:"date"},{key:"protocol_name",label:"\u901a\u8baf\u534f\u8bae"},{key:"description",label:"\u8bf4\u660e",span:2}]}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.load()}load(){this.rs.get(`client/${this.id}`).subscribe(e=>{this.data=e.data})}delete(){this.rs.get(`client/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529f"),this.router.navigateByUrl("/admin/client")})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(c.F0),t.Y36(g.dD),t.Y36(u.s),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-client-detail"]],standalone:!0,features:[t.jDz],decls:9,vars:4,consts:[["nzTitle","\u5ba2\u6237\u7aef\u8be6\u60c5",3,"nzExtra"],[3,"fields","value"],["nzTitle","\u8bbe\u5907"],[3,"tunnel_id"],["nzTitle","\u65e5\u5fd7"],["nz-tab",""],["extra",""],["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u8ba4\u5220\u9664",3,"nzOnConfirm"]],template:function(n,o){if(1&n&&(t.TgZ(0,"nz-card",0),t._UZ(1,"im-smart-info",1),t.TgZ(2,"nz-tabset")(3,"nz-tab",2),t._UZ(4,"app-devices",3),t.qZA(),t.TgZ(5,"nz-tab",4),t.YNc(6,fi,0,0,"ng-template",5),t.qZA()()(),t.YNc(7,zi,3,0,"ng-template",null,6,t.W1O)),2&n){const a=t.MAs(8);t.Q6J("nzExtra",a),t.xp6(1),t.Q6J("fields",o.fields)("value",o.data),t.xp6(3),t.Q6J("tunnel_id",o.id)}},dependencies:[p.ez,h.xH,h.xw,h.cj,m.bd,A.E,z.NU,z.$1,d.ix,c.rH,k.JW,w.Z]})}return i})(),title:"\u5ba2\u6237\u7aef\u8be6\u60c5",data:{breadcrumb:"\u5ba2\u6237\u7aef\u8be6\u60c5"}},{path:"client/:id/edit",component:_t,title:"\u5ba2\u6237\u7aef\u7f16\u8f91",data:{breadcrumb:"\u5ba2\u6237\u7aef\u7f16\u8f91"}},{path:"user",component:ee.b,title:"\u7528\u6237\u5217\u8868",data:{breadcrumb:"\u7528\u6237\u5217\u8868"}},{path:"user/create",component:et,title:"\u521b\u5efa\u7528\u6237",data:{breadcrumb:"\u521b\u5efa\u7528\u6237"}},{path:"user/:id",component:oe,title:"\u7528\u6237\u8be6\u60c5",data:{breadcrumb:"\u7528\u6237\u8be6\u60c5"}},{path:"user/:id/edit",component:et,title:"\u7f16\u8f91\u7528\u6237",data:{breadcrumb:"\u7f16\u8f91\u7528\u6237"}},{path:"setting/web",component:re,title:"\u8bbe\u7f6eWeb"},{path:"setting/database",component:ue,title:"\u8bbe\u7f6e\u6570\u636e\u5e93",data:{breadcrumb:"\u8bbe\u7f6e\u6570\u636e\u5e93"}},{path:"setting/broker",component:he,title:"\u8bbe\u7f6e\u6570\u636e\u603b\u7ebf",data:{breadcrumb:"\u8bbe\u7f6e\u6570\u636e\u603b\u7ebf"}},{path:"setting/mqtt",component:ge,title:"\u8bbe\u7f6eMQTT\u8fde\u63a5"},{path:"setting/log",component:ve,title:"\u8bbe\u7f6e\u65e5\u5fd7",data:{breadcrumb:"\u8bbe\u7f6e\u65e5\u5fd7"}},{path:"setting/backup",component:ye,title:"\u7cfb\u7edf\u5907\u4efd",data:{breadcrumb:"\u7cfb\u7edf\u5907\u4efd"}},{path:"setting/attach",component:fn,title:"\u9644\u4ef6\u7ba1\u7406",data:{breadcrumb:"\u9644\u4ef6\u7ba1\u7406"}},{path:"web",component:gt.c,title:"\u6269\u5c55\u9875\u9762",data:{breadcrumb:"\u6269\u5c55\u9875\u9762"}},{path:"alarm",component:bt.f,title:"\u544a\u8b66\u65e5\u5fd7",data:{breadcrumb:"\u544a\u8b66\u65e5\u5fd7"}},{path:"**",component:zt.h}];let Ci=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(yi),c.Bz]})}return i})(),Ti=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[p.ez,Ci,D.Qp]})}return i})()}}]);